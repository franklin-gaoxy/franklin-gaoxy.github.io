# 扩容

取消挂载

```shell
umount /dev/vdc
```

在一个磁盘新建两个分区

```shell
[root@mnode2 ~]# fdisk /dev/vdc 
Welcome to fdisk (util-linux 2.23.2).

Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table
Building a new DOS disklabel with disk identifier 0xeac9927e.
# 删除原有的分区
Command (m for help): d
No partition is defined yet!
# 新建分区
Command (m for help): n
Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): p
Partition number (1-4, default 1): 1
First sector (2048-2097151999, default 2048): #起始位置 使用默认
Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-2097151999, default 2097151999): +100G # 结束位置 +100G空间
Partition 1 of type Linux and of size 100 GiB is set
# 给第二个分区
Command (m for help): n
Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): p
Partition number (2-4, default 2): 
# 起始和结束全部使用默认
First sector (209717248-2097151999, default 209717248): 
Using default value 209717248
Last sector, +sectors or +size{K,M,G} (209717248-2097151999, default 2097151999): 
Using default value 2097151999
Partition 2 of type Linux and of size 900 GiB is set
# 修改为LVM格式
Command (m for help): t
Partition number (1,2, default 2): 1
# 修改为LVM
Hex code (type L to list all codes): 8e
Changed type of partition 'Linux' to 'Linux LVM'
# 保存退出
Command (m for help): w
The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
```

## 扩容根分区

```shell
[root@mnode2 ~]# pvcreate /dev/vdc1
  Physical volume "/dev/vdc1" successfully created.
# 查看VG组名称  
[root@mnode2 ~]# vgs                      
  VG         #PV #LV #SN Attr   VSize   VFree
  VolGroup00   1   2   0 wz--n- <38.97g    0 
[root@mnode2 ~]# vgextend VolGroup00 /dev/vdc1 
  Volume group "VolGroup00" successfully extended
[root@mnode2 ~]# df -h
Filesystem                       Size  Used Avail Use% Mounted on
devtmpfs                          48G     0   48G   0% /dev
tmpfs                             48G     0   48G   0% /dev/shm
tmpfs                             48G   17M   48G   1% /run
tmpfs                             48G     0   48G   0% /sys/fs/cgroup
# 复制根分区的路径
/dev/mapper/VolGroup00-LogVol00   38G  1.2G   37G   3% /
/dev/vdb                         100G   33M  100G   1% /home/bdms
/dev/vda2                       1014M   88M  927M   9% /boot
tmpfs                            9.6G     0  9.6G   0% /run/user/1001
# 扩容到根分区
[root@mnode2 ~]# lvextend -l +100%FREE /dev/mapper/VolGroup00-LogVol00
  Size of logical volume VolGroup00/LogVol00 changed from <37.47 GiB (1199 extents) to <137.44 GiB (4398 extents).
  Logical volume VolGroup00/LogVol00 successfully resized.
You have new mail in /var/spool/mail/root
# 重新加载
[root@mnode2 ~]# xfs_growfs  /dev/mapper/VolGroup00-LogVol00
meta-data=/dev/mapper/VolGroup00-LogVol00 isize=512    agcount=4, agsize=2455552 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=1        finobt=0 spinodes=0
data     =                       bsize=4096   blocks=9822208, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal               bsize=4096   blocks=4796, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
data blocks changed from 9822208 to 36028416
# 重新检查查看
[root@mnode2 ~]# df -h
Filesystem                       Size  Used Avail Use% Mounted on
devtmpfs                          48G     0   48G   0% /dev
tmpfs                             48G     0   48G   0% /dev/shm
tmpfs                             48G   17M   48G   1% /run
tmpfs                             48G     0   48G   0% /sys/fs/cgroup
/dev/mapper/VolGroup00-LogVol00  138G  1.2G  137G   1% /
/dev/vdb                         100G   33M  100G   1% /home/bdms
/dev/vda2                       1014M   88M  927M   9% /boot
tmpfs                            9.6G     0  9.6G   0% /run/user/1001
[root@mnode2 ~]#
```

## 挂载到数据盘

```shell
# 格式化为xfs类型
[root@mnode2 ~]# mkfs.xfs /dev/vdc2 
meta-data=/dev/vdc2              isize=512    agcount=4, agsize=58982336 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=1        finobt=0, sparse=0
data     =                       bsize=4096   blocks=235929344, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal log           bsize=4096   blocks=115199, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
# 创建目录和挂载
[root@mnode2 ~]# mkdir /mnt/data01
[root@mnode2 ~]# mount /dev/vdc2 /mnt/data01/
# 检查
[root@mnode2 ~]# df -h
Filesystem                       Size  Used Avail Use% Mounted on
devtmpfs                          48G     0   48G   0% /dev
tmpfs                             48G     0   48G   0% /dev/shm
tmpfs                             48G   17M   48G   1% /run
tmpfs                             48G     0   48G   0% /sys/fs/cgroup
/dev/mapper/VolGroup00-LogVol00  138G  1.2G  137G   1% /
/dev/vdb                         100G   33M  100G   1% /home/bdms
/dev/vda2                       1014M   88M  927M   9% /boot
tmpfs                            9.6G     0  9.6G   0% /run/user/1001
/dev/vdc2                        900G   33M  900G   1% /mnt/data01
[root@mnode2 ~]#
```

## 检查fstab文件

```shell
[root@mnode2 ~]# cat /etc/fstab 

#
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/VolGroup00-LogVol00 /                       xfs     defaults        0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot                   xfs     defaults        0 0
/dev/mapper/VolGroup00-LogVol01 swap                    swap    defaults        0 0
#VAGRANT-BEGIN
# The contents below are automatically generated by Vagrant. Do not modify.
#VAGRANT-END
/dev/vdb /home/bdms xfs defaults 0 0
/dev/vdc /mnt/dfs/0 xfs defaults 0 0
```
